{{append . "moreStyles" "css/admin/admin-user-create.css"}}
{{append . "moreScripts" "js/admin/admin-site-setup.js"}}
{{set . "title" "撰写文章"}}
{{template "Layout/AdminHeader.html" .}}
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main admin-user">
  <h2 class="page-header title">{{.title}}</h2> <span class="add"></span>
   <div class="row placeholders">
    <link rel="stylesheet" type="text/css" href="../public/edit/dist/css/wangEditor.min.css">
    <link rel="stylesheet" type="text/css" href="../public/edit/dist/css/select2.min.css">
    <link rel="stylesheet" type="text/css" href="../public/edit/dist/css/bootstrap-switch.min.css">
    <link rel="stylesheet" type="text/css" href="../public/edit/dist/css/bootstrap-markdown.min.css">
    <style>
     /*
      自定义样式标题
      */
      .edit_title input{
        -webkit-box-shadow:none;
        box-shadow: none;
      }
      /*
      自定义样式选择分类
      */
      .edit_category .select2-selection{
        height: 34px;
        border: 1px solid #ccc;
      }
      .edit_category .select2-selection:focus{
        border-color: #66afe9;
        outline: 0;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);
      }
      .edit_category .select2-container--default .select2-search--dropdown .select2-search__field{
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      .select2-search__field:focus{
        border-color: #66afe9 !important;
        outline: 0;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);
      }
      .edit_category .select2-container--default .select2-selection--single .select2-selection__rendered{
        line-height: 34px;
        color: #999;
      }
       .edit_category .select2-container--default .select2-selection--multiple .select2-selection__choice{
         background-color: #428bca;
         color: #fff;
       }
      /*
      自定义样式选择标签
      */
      .edit_tag .select2:focus{
        border-color: #66afe9;
        outline: 0;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);
      }
      .edit_tag .select2-selection{
        border: 1px solid #ccc;
      }
      .edit_tag .select2-container--default.select2-container--focus .select2-selection--multiple{
        border: 1px solid #ccc;
      }
      .edit_tag .select2-container--default .select2-selection--multiple .select2-selection__choice{
         background-color: #428bca;
         color: #fff;
         border-color: #428bca;
       }
       .edit_tag .select2-container--default .select2-selection--multiple .select2-selection__choice__remove{
         color: #efefef;
       }
       .edit_tag .select2-container--default .select2-selection--multiple .select2-selection__choice__remove:hover{
         color: #fff;
       }
       /*
       编辑器切换按钮
       */
       .edit_area .bootstrap-switch .bootstrap-switch-handle-on{
          border-bottom-left-radius: 30px;
          border-top-left-radius: 30px;
          border: 1px solid #337ab7;
       }
       .edit_area .bootstrap-switch .bootstrap-switch-handle-off{
          border-bottom-right-radius: 3px;
          border-top-right-radius: 3px;
          border: 1px solid #eee;
       }
       .edit_area .bootstrap-switch.bootstrap-switch-on .bootstrap-switch-label {
          border-bottom-right-radius: 30px;
          border-top-right-radius: 30px;
          border: 1px solid #ccc;
       }
       .edit_area .bootstrap-switch.bootstrap-switch-off .bootstrap-switch-label{
          border-bottom-left-radius: 30px;
          border-top-left-radius: 30px;
          border: 1px solid #eee;
       }
       .edit_area .bootstrap-switch{
          border-radius: 30px;
          border: none;
       }
       .edit_area .bootstrap-switch .bootstrap-switch-handle-off, .edit_area .bootstrap-switch .bootstrap-switch-handle-on, .edit_area .bootstrap-switch .bootstrap-switch-label{
         padding: 3px 12px;
       }
       .edit_area_type{
          height: 65px;
          border: 1px solid #ccc;
          border-bottom: none;
          overflow: hidden;
       }
       .edit_area_tips{
          float: left;
          height: 45px;
          line-height: 45px;
          margin-left: 15px;
       }
       .edit_switch_action{
         float: right;
         height: 45px;
          line-height: 45px;
       }
       .edit_area_type .switch{
         padding-top: 18px;
         width: 120px;
         float: right;
       }
       .edit_action_warp{
         float: right;
         height: 35px;
      margin-top: 15px;
      margin-right: 15px;
       }
    </style>
    <script type="text/javascript" src="../public/edit/dist/js/wangEditor.min.js"></script>
    <script type="text/javascript" src="../public/edit/dist/js/select2.full.min.js"></script>
    <script type="text/javascript" src="../public/edit/dist/js/bootstrap-switch.min.js"></script>
    <script type="text/javascript" src="../public/edit/dist/js/bootstrap-markdown.js"></script>
    <div class="panel panel-default">
      <div class="panel-body">
        <div class="edit_title">
          <form role="form">
            <div class="form-group">
              <h4 class="text-left" style="margin-bottom:10px;">文章标题</h4>
              <input type="" class="form-control" placeholder="输入文章标题">
            </div>
          </form>
        </div>
        <div class="edit_category text-left">
          <h4 class="text-left" style="margin-bottom:10px;">选择分类</h4>
          <select id="edit_category_select" class="form-control">
            <option value="AL">选择分类</option>
            <option value="AL">Alabama</option>
            <option value="WY">Wyoming</option>
          </select>
        </div>
        <div class="edit_tag text-left">
          <h4 class="text-left" style="margin-bottom:10px;">选择标签</h4>
          <select id="edit_category_tag" class="form-control" multiple="" tabindex="-1" aria-hidden="true">
            <option selected="selected">orange</option>
            <option>white</option>
            <option selected="selected">purple</option>
            <option value="red">red</option>
            <option value="blue">blue</option>
            <option value="green">green</option>
          </select>
        </div>
      </div>
    </div>
    <div class="edit_area">
      <div class="edit_area_type">
        <div class="edit_area_tips h5">编辑模式：普通</div>
        <div class="edit_action_warp">
          <button type="button" class="btn btn-primary">发布文章</button>
          <button type="button" class="btn btn-danger">存为草稿</button>
        </div>
        <div class="switch switch-mini">
            <input data-toggle="modal" data-target="#edit_change_moda" id="toggle-type" type="checkbox" checked />
        </div>
         <div class="edit_switch_action h5">模式切换</div>
      </div>
      <div id="edit_area_one">
        <textarea style="min-height:800px;" id="textareaOne">
          <p>请输入内容...</p>
        </textarea>
      </div>
      <div style="display:none;" id="edit_area_two">
       <textarea name="content" data-provide="markdown" rows="50"></textarea>
      </div>
    </div>
    <div id="edit_change_modal" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel">切换提示</h4>
          </div>
          <div class="modal-body">
            切换编辑模式会丢失当前内容！
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button id="edit_change_modal_sure" type="button" class="btn btn-primary">继续</button>
          </div>
        </div>
      </div>
    </div>
    <script type="text/javascript">
      // 视图模型
      var editView = {
        editType:false,
        modalType:false,
        editChangeBtn:$("#toggle-type"),
        editCategorySelect:$("#edit_category_select"),
        editCategoryTag:$("#edit_category_tag")
      }

      // 创建富文本编辑器
      var editor = new wangEditor('textareaOne');
      editor.create();

      //创建分类选择器
      editView.editCategorySelect.select2({
        ajax: {
          url: "localhost/query_categorys/",
          processResults: function (data, page) {
            console.log(data);
            var parsed = data;
            var arr = [];
            for(var x in parsed){
              arr.push(parsed[x]); //这个应该是个json对象
            }
            console.log(arr);
            return {
              results: arr
            };
          }
        }
      });

      //创建标签选择器
      editView.editCategoryTag.select2({
        tags: true
      })

      // 创建选择编辑器开关
      editView.editChangeBtn.bootstrapSwitch({
        onText:'ON',
        offText:'OFF',
        labelWidth:10,
        handleWidth:50,
        state:false,
        onSwitchChange:function(event,state){
          editView.editType = state;
          editView.modalType = false;
          $("#edit_change_modal").modal('show');
        }
      });

      //监听模态框关闭事件
      $(function () { $('#edit_change_modal').on('hide.bs.modal', function (e) {
          if(!editView.modalType){
            editView.editChangeBtn.bootstrapSwitch('state',!editView.editType);
          }
        })
      });

      //确认切换模态框
      $('#edit_change_modal_sure').click(function(){
        editView.modalType = true;
         $("#edit_change_modal").modal('hide');
         if(editView.editType){
            $(".edit_area_tips").text('编辑模式：Markdown');
            $("#edit_area_one").hide();
            $("#edit_area_two").show();
            return;
          }
          $(".edit_area_tips").text('编辑模式：普通');
          $("#edit_area_one").show();
          $("#edit_area_two").hide();
      })
    </script>
  </div>
</div>
 <div>
{{template "Layout/AdminFooter.html" .}}